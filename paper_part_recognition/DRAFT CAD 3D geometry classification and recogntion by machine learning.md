# DTVCNN: an efficient machine learning modle for 3D CAD Geometry Classification and Recognition

Qingfeng Xia

Affilication

Email: qingfeng.xia@

Abstract:

Introducing deep learnning on 3D shape, which contribute to the automatic and intelligent engineering design-simulation workflow, is a drive for the digital transformation of the mechanical engineering design. The speciality of 3D geometry generated by Computer-aided Design (CAD) software invites brand-new preprocessing algorithm and neural network  other than those designed for surface-mesh based 3D geometry, for more efficient machine learning,. In this paper, an efficient 3D shape to 2D images projection algorithm is proposed; the proejected iamge is coined as ‚Äúthickness ???‚Äù which mimic x-ray rendering. Similar with depth map image,  ‚Äúthickness ???‚Äù 2.5D image bearing more information high entropy in Shannon‚Äôs information theory.  Depth image and thickness image from a specific 3D project views,  to bear geometry  topology feature into 2 grayscale image channels, deep coupled channel is locality, just as RGB for color image.  Based on several essential geometry properties  (primitive scalars) and only 3 projects views,  a hybrid approach NN is designed with validation accuracy to 92% for ModelNet10 dataset.  The 

**Keywords:** CAD,  topology, 3D classification, CNN, deep learning

# 1. Introduction

## Challenges in bringing AI into engineering design

Automated and intelligent engineering  design.  

The emerging Exa-scale (1x1018 operation per second) HPC offers the computation capacity to accelerate the design of large complex systems, such as a fusion reactor. The combination of efficient massively parallel simulation solvers and automated integrated design workflow facilitates a holistic view of the design and a complete simulation-based view of the system. 

The inherent characteristics of digital engineering are continuously evolving by integration news tech, to revolute persistent tradictional practice.  
The current method used to design a large complex facility is subsystem decomposition, where each subsystem is designed independently until the stage of system integration. Ineffcient and difficulty of integratoin

Exa-scale simulation.  The number of thousands to handreds of thousands parts. 

AI can contribute to the automation design-simulation workflow.  The design of a complex product needs several design iterations. Without a continuous integration workflow as in software engineering, the overall design period of an aero-engine model or a fusion reactor demonstration facility, would be much longer than a large-scale software project.  

The gap between CAD and CAE software is often a major obstacle towards workflow automation for engineering design and simulation. Traditionally, geometry in CAD software is manufacturing oriented, containing too much manufacturing detail which must be removed before it is fed into CAE software. Unfortunately, geometry modification in upstream CAD software always breaks the downstream simulation setup due to a loss of critical geometry specific metadata. Given the fact that the whole geometry at the detailed design stage may have one million (or more) faces, manually re-applying boundary conditions to each face without an automated tool, is time-consuming or may even be unachievable. 



Exept for the lack of well-defiend Dataset, efficient deep learning model is desired to accelerate the training .  Deep learning is time-consuming, 3D geometry data, one dimension higher than 2D images.  

###  CAD and CAE gap, topology

standard, or vendor-neutral CAD data format. 

The gap between CAD and CAE software is often a major obstacle towards workflow automation for engineering design and simulation. Traditionally, geometry in CAD software is manufacturing oriented, containing too much manufacturing detail which must be removed before it is fed into CAE software. Unfortunately, geometry modification in upstream CAD software always breaks the downstream simulation setup due to a loss of critical geometry specific metadata. Given the fact that the whole geometry at the detailed design stage may have one million (or more) faces, applying boundary conditions to each face without an automated tool, is time-consuming or may even be unachievable. Therefore, the necessity of advanced preprocessing software bridging CAD and CAE software is evident, in the context of designing large and complex systems especially when multiple design iterations are expected. This tool can not only enable continuous design-simulation workflow, but also lay solid foundation for future intelligent engineering design.

### preprocessing is time consuming
data entry must be equal length


processing is based on 3D surface mesh,  volume, surface, distance, collsion type, etc.  CAD on gpu is not yet heard. not yet parallelized.

### multi-body segmentation
image segmentation. extract , backgroud. 
subassembly, enforced by designer, 

relationship with other parts can be crucial to identify a non-standard part. 



## Application of deep learning on CAD geometry 

### classification and recognition

## Speciality of CAD 3D object

\+ CAD only planar surface, surface types

\+ no texture, material

\+ precise,  volume, key dimension

standard part

Part and component level,  not for final project, texture 2D image could be a more efficient way

### 



## Aim of this paper

CAD data format, STEP, is first study, to the author' knowledge.

CAD data file preprocessing.  a hybrid approach combining geometrical properties and visual representaton 
image compressing. optionally

Decrease input data size, can reduce the model parmaters thus the training time. 

# 2. Literature review
## Overview of algorithms for 3D object recognition

<https://github.com/timzhang642/3D-Machine-Learning>

- üì∑ Multi-view Images
- üëæ Volumetric
- üé≤ Point Cloud
- üíé Polygonal Mesh
- üíä Primitive-based

## Voxel 

3D printing, boxer 3D volume meshing. most intuitive way to represent 3D object, but the memory cost is high. 

Mechical scan, when 

section views and slicing (DICOM)  "Real-time Voxelization for Complex Models"

https://github.com/chrischoy/3D-R2N2 3D dense voxel , convert shape into dense 3-dim array, which consume huge memory and CPU computation resource. 

3D sparsity pattern reconstruction page, is worth of following up. 

3D conv and 3D voxel is one more dim, is also very slow

## Multiple viewpoints image

a series of 2D images from different view points.

 while mechianical egineering drawing, use three 2D views to represent a 3D object without loss of information. 

add image of that 

[Learning Multi-View Representation With LSTM for 3-D Shape Recognition and Retrieval](https://ieeexplore.ieee.org/document/8490588)

> most multiview-based methods ignore the correlations of multiple views or suffer from high computional cost. 
long short-term memory (LSTM) to exploit the correlative information from multiple views.

MVCNN for not oriented shape 12views, 80 views, training is very slow.

## Point cloud and surface tellesselaton mesh

3D part file like mesh, is based on Vertex, with topology like edge and face, more efficent than point cloud and surface mesh to fully define a 3D geometry. 

Let machine learn the topology is 

## Primitive-based: geometrical properties

(centre, normal, area)



## Hash algorithm for fuzzy matching

Mechanical part has standard part, ISO standard, such as fastening. 
but threading. 

**name** of hte part in part meta data  can be very helpful, but there is no guranteree, meta data correctness and complement in the design workflow. 

The design target is a mixture of standard parts and adhoc design . 



### Shannon information entropy theory

multi-view input images rendering, different 

### Traditional mechanical drawing

edge and corners can be viewed by a binary image, 

![](/mnt/windata/MyData/OneDrive/gitrepo/PartRecognition/paper_part_recognition/assets/part_techdraw.png)

While NN accept grayscale and even colorful images, which bear more feature in the given input data size. 

# 3. Data set and Model design

### Taxigony:  classification of 3D part

text book classificaton



### ModelNet

ModelNet10  [ref] ShapeNet

some CAD file is not manifold, internal face, so will not 

3808 files, out of ModelNet10 dataset of ???



### Introduction to FreeCAD library dataset

<https://github.com/FreeCAD/FreeCAD-library> is not the most complete mechanical design dataset compared wtih commercial CAD software  , but it is permissively licensed with CC-BY 3.0 . 

<gradcad.com>  for each catelogy, there may not not enough

1543 Mechnical part, selection ? catelogy

|      |      |      |
| ---- | ---- | ---- |
|      |      |      |
|      |      |      |
|      |      |      |

Or from Fasteners selection 

SpaceClaim's product line includes a standard parts library supplied by TraceParts

## 

![img](assets/keras_multi_input_mixed_data.png)



## Preprocessing algorithm

block-schematic

Thickness projection image can be achieved by bool operation, the common of parallel rays and the target part. 

![image-20210124175014913](/mnt/windata/MyData/OneDrive/gitrepo/PartRecognition/paper_part_recognition/assets/part_XY_view_with_rays.png)![image-20210124175353003](/mnt/windata/MyData/OneDrive/gitrepo/PartRecognition/paper_part_recognition/assets/part_XY_view_edges_intersected.png)

figure of grid and shape intersection



Depth map has been widely used in pointNet for 3D shape classification

### DT view

Thickness view bear more information, not only edge and corner, but also internal holes, They are all import topo information.



![](/mnt/windata/MyData/OneDrive/gitrepo/PartRecognition/paper_part_recognition/assets/part_dt_view.png)

## Neural network design

a plot generate by tensorflow seems too detailed, too big to fit in





# 4. Evaluation and benchmarking

find and time profile it

### Model variant comparison on ModelNet10 dataset

Introduction to each variant:

| Performance factor         | DTVCNN | DT4VCNN | thickness only | DTVCNN no MLP |
| -------------------------- | ------ | ------- | -------------- | ------------- |
| Trainable parameter        |        |         |                |               |
| Accurary                   |        |         |                |               |
| sample data size in (Byte) |        |         |                |               |

The coupling of depth map and thickness map is the key for the high acur, given only 3 orthegornal views.

single channel, dual channel, does not affect training time.

Increase views to 6 may significantly improve the accurancy? 

## Comparison with MVCNN and VoxNet

latest code with Tensorflow2 API, 

| Performance factor         | MVCNN        | VoxNet   | DTVCNN    |
| -------------------------- | ------------ | -------- | --------- |
| Trainable parameter        |              |          |           |
| Accurary                   |              |          |           |
| sample data size in (Byte) | 12X227X227X3 | 32X32X32 | 3X60X60X2 |

Input data size for each sample is 21600 bytes, while   Conv3D is more time consuming



Source code is available with latest TensorFlow API,  on github 

oriented modelnet10

Time to train:  Conv3D is very slow?

Train on laptop CPU,  

smaller model size, integrated into CAD and CAE software in the future.  Parallel-preprocessor. 

### Performance using different dataset

reason for the 




# 5. Conclusion

Information entropy ,  accuracy to 92% on ModelNet10 by only 3 views, 

smaller model size, integrated into CAD and CAE software in the future.  Parallel-preprocessor. 

# Disclaimer and acknowledgement 

This is a personal research, it is not related with employment work scope. Thank to my family support to finish this work in off-office time.  Open source tools

The currently employer can provided computation resource to evaluate large dataset such as ModelNet40.

Patent, IP.

Dr Weidi Xie of University of Oxford

Sponsorship to conference by ??